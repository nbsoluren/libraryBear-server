{"version":3,"sources":["../../src/api/index.js"],"names":["library","extras","config","db","api","use","post","req","res","checkUser","body","queryResult","action","searchBooks","searchBooksByAuthor","searchBooksByCategory","searchBooksByTitle","console","log","showAllBooks","showAllAvailableBooks","showBorrowedBooks","json","fulfillmentText"],"mappings":";;;;;;AAAA;;AACA;;AACA;;AACA;;;;AACA;;IAAYA,O;;AACZ;;IAAYC,M;;;;;;;;AACZ;AACA;AACA;;kBAEe,gBAAoB;AAAA,KAAjBC,MAAiB,QAAjBA,MAAiB;AAAA,KAATC,EAAS,QAATA,EAAS;;AAClC,KAAIC,MAAM,sBAAV;;AAEA;AACAA,KAAIC,GAAJ,CAAQ,SAAR,EAAmB,sBAAO,EAAEH,cAAF,EAAUC,MAAV,EAAP,CAAnB;;AAEA;AACAC,KAAIE,IAAJ,CAAS,eAAT;AAAA,sEAA0B,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAElBR,QAAQS,SAAR,CAAkBN,EAAlB,EAAsBI,GAAtB,EAA2BC,GAA3B,CAFkB;;AAAA;AAAA,qBAIjBD,IAAIG,IAAJ,CAASC,WAAT,CAAqBC,MAJJ;AAAA,uCAKlB,cALkB,uBAOlB,wBAPkB,uBASlB,0BATkB,uBAWlB,uBAXkB,uBAalB,gBAbkB,wBAgBlB,0BAhBkB,wBAkBlB,qBAlBkB;AAAA;;AAAA;AAAA,wCAMfZ,QAAQa,WAAR,CAAoBV,EAApB,EAAwBI,GAAxB,EAA6BC,GAA7B,CANe;;AAAA;AAAA,wCAQfR,QAAQc,mBAAR,CAA4BX,EAA5B,EAAgCI,GAAhC,EAAqCC,GAArC,CARe;;AAAA;AAAA,wCAUfR,QAAQe,qBAAR,CAA8BZ,EAA9B,EAAkCI,GAAlC,EAAuCC,GAAvC,CAVe;;AAAA;AAAA,wCAYfR,QAAQgB,kBAAR,CAA2Bb,EAA3B,EAA+BI,GAA/B,EAAoCC,GAApC,CAZe;;AAAA;AActBS,eAAQC,GAAR,CAAY,QAAZ;AAdsB,wCAeflB,QAAQmB,YAAR,CAAqBhB,EAArB,EAAyBI,GAAzB,EAA8BC,GAA9B,CAfe;;AAAA;AAAA,wCAiBfR,QAAQoB,qBAAR,CAA8BjB,EAA9B,EAAkCI,GAAlC,EAAuCC,GAAvC,CAjBe;;AAAA;AAAA,wCAmBfR,QAAQqB,iBAAR,CAA0BlB,EAA1B,EAA8BI,GAA9B,EAAmCC,GAAnC,CAnBe;;AAAA;AAAA,wCAsBfA,IAAIc,IAAJ,CAAS,EAAEC,iBAAiB,4BAAnB,EAAT,CAtBe;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAyBxBN,eAAQC,GAAR;AAzBwB,wCA0BjBV,IAAIc,IAAJ,CAAS,EAAEC,iBAAiB,sBAAnB,EAAT,CA1BiB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA1B;;AAAA;AAAA;AAAA;AAAA;;AA8BA,QAAOnB,GAAP;AACA,C","file":"index.js","sourcesContent":["import 'babel-polyfill';\nimport { version } from '../../package.json';\nimport { Router } from 'express';\nimport facets from './facets';\nimport * as library from './library';\nimport * as extras from './extras';\n// import * as weather from './weather';\n// import * as worldTime from './world_time';\n// import * as ytsList from './yts_list';\n\nexport default ({ config, db }) => {\n\tlet api = Router();\n\n\t// mount the facets resource\n\tapi.use('/facets', facets({ config, db }));\n\n\t// perhaps expose some API metadata at the root\n\tapi.post('/bear-webhook', async (req, res) => {\n\t\ttry {\n\t\t\tawait library.checkUser(db, req, res);\n\n\t\t\tswitch(req.body.queryResult.action) {\n\t\t\t\tcase 'search-books':\n\t\t\t\t\treturn library.searchBooks(db, req, res);\n\t\t\t\tcase 'search-books-by-author':\n\t\t\t\t\treturn library.searchBooksByAuthor(db, req, res);\n\t\t\t\tcase 'search-books-by-category':\n\t\t\t\t\treturn library.searchBooksByCategory(db, req, res);\n\t\t\t\tcase 'search-books-by-title':\n\t\t\t\t\treturn library.searchBooksByTitle(db, req, res);\n\t\t\t\tcase 'show-all-books':\n\t\t\t\t\tconsole.log(\"called\");\n\t\t\t\t\treturn library.showAllBooks(db, req, res);\n\t\t\t\tcase 'show-all-available-books':\n\t\t\t\t\treturn library.showAllAvailableBooks(db, req, res);\n\t\t\t\tcase 'show-borrowed-books':\n\t\t\t\t\treturn library.showBorrowedBooks(db, req, res);\n\n\t\t\t\tdefault:\n\t\t\t\t\treturn res.json({ fulfillmentText: 'There is an error ðŸ‘¾rstrst' });\n\t\t\t}\n\t\t} catch(e) {\n\t\t\tconsole.log(e)\n\t\t\treturn res.json({ fulfillmentText: 'There is an error ðŸ‘¾' });\n\t\t}\n\t});\n\n\treturn api;\n}\n"]}